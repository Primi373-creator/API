
const axios = require("axios");
const cheerio = require("cheerio");

module.exports = (async (query) => {
  let { data } = await axios(
    `https://pinterest.com/search/pins/?q=${encodeURIComponent(
      query
    )}&autologin=true`,
    {
      headers: {
        cookie:
          'csrftoken=9928db42c6dec5d57477b2a6d05eda6c;_pinterest_referrer=https://www.google.com/;cm_sub=none;_b="AXgvYPqqp7dAkpbnog6g5RYDN4/2Y4IYaz38isorPvuzMjPVUWOajReCQ721n3CWgoI=";_pinterest_sess=TWc9PSZzSEw0eWw4bGFDR3MzUmx3UXg4bmFjTURjaUFlaWM2SGFiQTNEZEQxSnN6eGVaTkZxRW10QStwTWRCRWxScWQyNkg1TDhJb3V6dk5Gdnl0bWlJWDJuam54S01Jd29FQ1dGbnNIRE02THhmOG5YQlZhOFI1SHRxN1o1NnZFdWMyNHBHZVVZMnNnYmxzYWViRlAzMllPdzc3bkNpTVlUMGxMNmdaNGx3Z040a3orUG5iRlY1Y1RUVFRyQmQ2TTdZODlndTdRZGRxZ1JWNk5nNU1lQ2lZUGNoOEVIYXhWM2VobGo4T0JuUFRMQnppWUtBNDAreTNReVZVMzlRRUE3Yi90Qkl1ZElrUWk1aHdrbnRjQTlxUVIveXAwQ1hSbFJnV1pjVjNsMk5nRkhMRFF5UE1RYVdMaTN0eEQwNnBsWDJJK3BYL1NpUEg4Wng5dHQ2cnVQRkpYUjkyTmdhWE4xYk54cnpCZVliZ2dPQTU2MU5UMENIR1h6dW02cDNTeUczOEo0UmtWbEFwY3NJYyt3TWdJbGRUU2NSNzd0VjcrS2w2dzczT1JLTGcybWJETlFmUnFqQTVTbWJjY1dGcFgzaFJ6OUFsWEM1UlNwd29YUGJoRk9yeWltQkdCMi9wcStDbVZHS1NNUDF5Wm1QSE5vclM4L1pUa2d1SG1uZlg1cC9RQ0ZVdTRoMDJoTlRBYU9EMDdieVRraWM4aFBLdXZ2KzMrekpTU1pweEhwL2JRRVJCb0kzSnJZekFLTkdCdURkSFh2YW8waEVheEdNNzdQd3VGVjRCeTJyUmRvOFZCMHY0TVJua2crSk5FY0NnNlpkTFZpQjhVODJNVENGamJrY3hGZTY1OGlMeXRaeGNVZHdTWlBtZ0J6aDFEYlZ3anhIR2N1UUY2MHVmZDUzMU00aXJrVFAvNEtNREdFcTFTc2xPQ25KUmhLT0Y0c3dsQU5lUUh3VVB3NVloenF2ZU5ZUlBTdjViaEFIVXY2UUsvMjhPTkgrZExXeW44SWZIUFUzaXhZVHUrSlovdFhWQ1NsY2VKa1Z2KzFpNzlNeGI5Kzd2SThScER0S0pDSG9EaTFxVnE2NkFzcEFXVDRSbkxVdkxKMEY4bEdXV0NDNnE1dnFLeHNSY05IUGRGTGJ6OEJEUnE1NG55YnhFRlJhY0NRSi8vUnpmYVFMYURRSFZydktNM2tiN2lXdEhyNXBMR2hXRUwxV3BFRk5UKzR5STNnNVB1Z00rV3E2Tnp2MFpNNng2aDVlWTFva1NudTRrV2hzalN4NVdvSHlNWnRVVE40U25XSWdNcDJONXJuVHN1QVdQTGJpQ01YMjZaUnBGampVN1VUWU9CQUxHckZvb3V3cENlbnNuSnFCcmRlRmVzM0RqU05CMm1nMmZHc1BBdzlTaUg1TW9WRXJSM0d4MnY3S0ZTTHFkMkhkdG5BUW5HR2hMOGUvejF6UjAreXBsa3FybzZxTkVzTUZRaDZhTGd1THdENHdDODFJV1lTdDltOWZzWHBMSkltcXg2cHlWbEV2MlR1VDY5dzlvdnBHdTEzM3JhZXlXOHpxTlg2ZU9zSDlLZ1Z4eWlLSW9rek0wdTFpQkZCMnB2aVNKNVVyR3RRbFNQZjFDYUhlREw5WjNNSitJNFpjVityVTRyU3dHWmdmMEhaRDMvTjRhNnNXTkdvNFFSWHpiUTlZVHRmRXEvL2xUck9uOHk4cmpUb0NNUkFsVUExdjkzSDJ5aitraTBUNWZuMlhFbGdPQW1uYzYvdWE5aXFtMEdmVzBueHdzWnJpcUMmMDBTNlY5NjhNVUViL25nU2Yvemp4MXJod0tvPQ==;ar_debug=1;__Secure-s_a=c2Y4bVcvYlpxaGNnaW96VGJFT3JqTGhSd1JkbjR1VXVEVW44VlVTaGxzMVVXamZqT3k1aGxIK1ZRYXh2T0lNd0hDMW1zWHNjSWpLNGZkWCt6dnQzQUFvVmxYQWkxVFIrbWIybUJ2Q2RqbVNQdFgvdFYxRGp6YnFrU3ZmTDZDcG1IWmZGL25qbjMzWXU1ZVlsajRxYTBra3hBaHhTQ3VTN0h4NlIxVWh2b2g3aHZ5eFBsSTdqY1oydVJRNXM1RXJLcDZLeElxL3IxTjBNQy90aFRzekpFdDRUMXZkK0lPVVR1dGtRZGkwTEsxdm1oRXp0OU9VeGtjSGl4a3ZsQm16TWMzWG00SjlnaWY0eVJJV1pEMkJhU0xCWmQxTlpPOGkrZHAreExDeXdIdzVRUGU4MC83aFROVDBmMWdvT1ZKL0ZoYWZCdW5zNDhBZGIwLzZ4eXEyK1dhTjZWZUJjeDhzODJmYVRTVDhXREZpSTErb0Z1bmJXRjVPUTM4THZzVXF2VGR4WnREMW55N1JtdEI5eCtBV0Jpd1lDZDRhSXc2QmpSWExZQVpyaFp5K2hIbzhad2x1VHlPa0JSUGZaUC9lV09wOFNPVzRqdjZCdXlHK2RMakF2Sk5WbVhsSVJZVXBWRmI3U0xoTjNla2pFTE1ZZUY4bEJZeE1YUDRyOHR3V3k3d3lBWmR4aUF2LzdDbFJWT25ibXpvWUxlVWc1NEhvRHNuR0R4Y1ZFNVIwVWFwWHdRb3VIb0hYeGJiREhoZmRVOU9sYU5qQVd1YjNmeitKV1l4dE5ESUlTMldmQ01HNW5NSzhTRnlNUklxLzhhdy9ZSjhTRjR2S3BINjh4ZW53MS9CT2dKclBNNjJTS0RlWXhSOU90Q205b2hZREVacnFGcnJKVzM3OEpEMExoeHU2eXEyYUhwTmhaMGNUZjhCRHphdGdxK1hZcGFPNENGUHhlOXVwWkNJM3hwcmorZ09WWlQ5TmV2M2Y5SWNOS2QxRmwyVU1JdThQR2dOeHFvM29WK0NOTUtnQ3dqcUVQYmc2OVZ5NDRqMVQvUEFCR1F5eWRwekh4eUMzYmJWUVJWVEt5S29IcHNweEMvYWR4eTN4NE40SUF4SktxcEFKOU9aYTlMNHc0STBEODFjMFBaZ0dVbXhDRTROeFlvczdxb1FJSTQremJjaDVNd2FnVTFOSlp5UzJ0S2ZUZXRVNTB1bXlSUEVkb01uT09XOUFRelRicHczVllWUW05bUdrS256ZXU4dFl5V2lqa3grbXR0YVpUNzZnamhMVUE3UDFUTlhPSFFlZEQ4bmlSNXV3R3RWVFRWSXdwQVBSaGk3QT0meWpocnpXUy9iK0RDUHRaUWY4YUtyWUZ0dzJBPQ==;_auth=1;_routing_id="7822dcc5-5007-41e1-a351-6b724024d03a";ar_debug=1;g_state={"i_l":0};sessionFunnelEventLogged=1',
      },
    }
  );
  $ = cheerio.load(data);
  return $("div > img")
    .get()
    .filter((a) => a.attribs.src && !/75x75_RS/.test(a.attribs.src))
    .map(
      (a) =>
        "https://i.pinimg.com/originals/" +
        a.attribs.src.split("/").slice(4).join("/")
    );
}).bind();
